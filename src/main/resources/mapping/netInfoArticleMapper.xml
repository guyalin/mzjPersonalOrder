<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.woniu.mzjOrder.dao.NetInformationDao">


    <insert id="saveArticleRecords" parameterType="list">
        insert ignore into t_net_article (
            root_url,title,target_url,article_name,article_title,area,date_time
        ) values
        <foreach item="item" collection="list" separator=",">
            (#{item.rootUrl},#{item.urlTitle},#{item.targetUrl},#{item.articleName},
             #{item.articleTitle},#{item.area},#{item.dateTime})
        </foreach>
    </insert>

    <select id="queryArticleRecordsByParams" parameterType="com.woniu.mzjOrder.vo.NetInfoQueryParamVo"
            resultType="com.woniu.mzjOrder.entity.ArticleRecord">
        select root_url as rootUrl,title as urlTitle,target_url as targetUrl,
               article_name as articleName,article_title as articleTitle,area,date_time as dateTime
        from t_net_article
        where 1 = 1
        <if test="paramVo != null and paramVo.area != null">
            AND area like #{paramVo.area}
        </if>
        <if test="paramVo != null and paramVo.latestDays != null">
            <![CDATA[AND date_time >= date_sub(CURRENT_DATE(), interval #{paramVo.latestDays} day)]]>
        </if>
        <if test="paramVo != null and paramVo.articleTitleRegex != null">
            AND
            <foreach collection="paramVo.articleTitleRegex" item="paramVo.articleTitleRegex" open="(" close=")" separator="or">
                article_title LIKE CONCAT('%', #{paramVo.articleTitleRegex}, '%')
            </foreach>
        </if>
        order by date_time desc;
    </select>
</mapper>